(function() {
    'use strict';

    document.addEventListener('DOMContentLoaded', function() {
        initializeAnimations();
        initializeScrollReveal();
        initializeHeroAnimation();
    });

    function initializeAnimations() {
        window.addEventListener('load', function() {
            document.body.classList.add('is-loaded');
        });
    }

    function initializeScrollReveal() {
        if (typeof ScrollReveal !== 'undefined') {
            const sr = ScrollReveal({
                origin: 'bottom',
                distance: '40px',
                duration: 1000,
                delay: 200,
                easing: 'cubic-bezier(0.5, 0, 0, 1)',
                scale: 1,
                reset: false
            });

            sr.reveal('.feature', {
                interval: 200
            });

            sr.reveal('.pricing-table-inner');
            sr.reveal('.cta-inner');
        }
    }

    function initializeHeroAnimation() {
        if (typeof anime !== 'undefined' && document.querySelector('.hero-figure')) {
            const heroFigure = document.querySelector('.hero-figure');
            heroFigure.classList.add('anime-element');
            
            const boxes = document.querySelectorAll('.hero-figure-box');
            
            boxes.forEach((box, index) => {
                box.style.opacity = '0';
                box.style.transform = 'scale(0) rotate(0deg)';
                
                anime({
                    targets: box,
                    opacity: [0, 1],
                    scale: [0, 1],
                    rotate: function() {
                        const rotation = box.getAttribute('data-rotation');
                        return rotation ? [rotation, rotation] : [0, 0];
                    },
                    delay: index * 100,
                    duration: 800,
                    easing: 'easeOutElastic(1, .8)'
                });
            });

            anime({
                targets: '.anime-element',
                opacity: [0, 1],
                translateY: [30, 0],
                duration: 800,
                easing: 'easeOutCubic'
            });
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });

    if ('IntersectionObserver' in window) {
        const featureObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-revealing');
                }
            });
        }, {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        });

        document.querySelectorAll('.feature').forEach(feature => {
            featureObserver.observe(feature);
        });

        const pricingObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-revealing');
                }
            });
        }, {
            threshold: 0.1
        });

        document.querySelectorAll('.pricing-table-inner').forEach(pricing => {
            pricingObserver.observe(pricing);
        });
    }

})();